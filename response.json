{
  "source_table_name": [
    "MARA_500",
    "MARA_700",
    "MARA"
  ],
  "source_field_names": [
    "MATNR",
    "MEINS",
    "MTART"
  ],
  "filtering_fields": [
    "MATNR",
    "MTART"
  ],
  "insertion_fields": [
    "MEINS"
  ],
  "transformation_logic": {
    "step_1": {
      "description": "Check for materials in MARA_500 that exist in the target table based on the PRODUCT:MATNR key mapping.",
      "source_table": "MARA_500",
      "join_condition": "MARA_500.MATNR = TargetTable.PRODUCT",
      "condition": "Record exists in MARA_500",
      "action": {
        "type": "insert",
        "target_field": "MEINS",
        "source_field": "MARA_500.MEINS"
      }
    },
    "step_2": {
      "description": "If no matching record is found in MARA_500, check MARA_700 for materials of type 'ROH' that exist in the target table based on the PRODUCT:MATNR key mapping.",
      "source_table": "MARA_700",
      "join_condition": "MARA_700.MATNR = TargetTable.PRODUCT",
      "condition": "Record exists in MARA_700 AND MARA_700.MTART = 'ROH'",
      "action": {
        "type": "insert",
        "target_field": "MEINS",
        "source_field": "MARA_700.MEINS"
      }
    },
    "step_3": {
      "description": "If no matching record is found in MARA_500 or MARA_700, check MARA for materials that exist in the target table based on the PRODUCT:MATNR key mapping.",
      "source_table": "MARA",
      "join_condition": "MARA.MATNR = TargetTable.PRODUCT",
      "condition": "Record exists in MARA",
      "action": {
        "type": "insert",
        "target_field": "MEINS",
        "source_field": "MARA.MEINS"
      }
    }
  },
  "Resolved_query": "For each material in the target table (PRODUCT), check if the material number (MATNR) exists in MARA_500. If it does, insert the corresponding Base Unit of Measure (MEINS) into the target table. If not, check if the material number (MATNR) exists in MARA_700 and the Product Type (MTART) is 'ROH'. If both conditions are met, insert the corresponding Base Unit of Measure (MEINS) into the target table. If the material is not found in either MARA_500 or MARA_700, check if the material number (MATNR) exists in MARA and insert the corresponding Base Unit of Measure (MEINS) into the target table.",
  "target_table": [
    "t_24_Product_Basic_Data_mandatory_Ext"
  ],
  "key_mapping": [
    {
      "target_col": "PRODUCT",
      "source_col": "MATNR"
    }
  ]
}