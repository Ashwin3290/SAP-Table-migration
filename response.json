{
  "source_table_name": [
    "MARA",
    "MARA_500",
    "MARA_700"
  ],
  "source_field_names": [
    "MATKL",
    "MEINS"
  ],
  "filtering_fields": [
    "MATKL"
  ],
  "insertion_fields": [
    "MEINS"
  ],
  "transformation_logic": {
    "steps": [
      {
        "step": 1,
        "description": "Check Material Group (MATKL) in MARA table and assign a value based on its value.",
        "source_table": "MARA",
        "conditions": [
          {
            "condition": "MATKL in ('L002', 'ZMGRP1', '202R')",
            "target_value": "GENAI01"
          },
          {
            "condition": "MATKL in ('01', 'L001', 'ZSUK1RM1')",
            "target_value": "GENAI02"
          },
          {
            "condition": "MATKL in ('CH001', '02')",
            "target_value": "GenAI03"
          },
          {
            "condition": "ELSE",
            "target_value": "GenAINo"
          }
        ]
      },
      {
        "step": 2,
        "description": "If no entries are found in MARA_500 for the given material number (MATNR), then check MARA_700 for the same material number (MATNR) and retrieve the Base Unit of Measure (MEINS).",
        "source_table": "MARA_700",
        "target_table": "MARA",
        "condition": "No entries found in MARA_500 for MATNR",
        "action": "Retrieve MEINS from MARA_700 where MATNR matches",
        "key_mapping": "PRODUCT:MATNR"
      },
      {
        "step": 3,
        "description": "If no entries are found in MARA_700 for the given material number (MATNR), then retrieve the Base Unit of Measure (MEINS) from the MARA table.",
        "source_table": "MARA",
        "target_table": "MARA",
        "condition": "No entries found in MARA_700 for MATNR",
        "action": "Retrieve MEINS from MARA where MATNR matches",
        "key_mapping": "PRODUCT:MATNR"
      }
    ]
  },
  "Resolved_query": "For each product, check the Material Group (MATKL) in the MARA table. If MATKL is in ('L002', 'ZMGRP1', '202R'), then assign 'GENAI01'. Else if MATKL is in ('01', 'L001', 'ZSUK1RM1'), then assign 'GENAI02'. Else if MATKL is in ('CH001', '02'), then assign 'GenAI03'. Otherwise, assign 'GenAINo'. If no entries are found in MARA_500 for a given product number (MATNR), check MARA_700 for the same product number and retrieve the Base Unit of Measure (MEINS). If no entries are found in MARA_700, then retrieve the Base Unit of Measure (MEINS) from the MARA table.",
  "target_table": [
    "t_24_Product_Basic_Data_mandatory_Ext"
  ],
  "key_mapping": [
    {
      "target_col": "PRODUCT",
      "source_col": "MATNR"
    },
    {
      "target_col": "PRODUCT",
      "source_col": "MEINS"
    }
  ]
}